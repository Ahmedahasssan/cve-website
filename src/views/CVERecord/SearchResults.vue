<template>
    <div id="cve-secondary-page-main-container">
      <div class="columns is-centered">
        <div class="column is-8-desktop cve-main-column-content-width">
          <main id="cve-main-page-content" role="main">
            <div class="content" v-if="this.$store.state.cveRecordIsLoading || this.$store.state.searchResultIsLoading">Loading...</div>
            <div class="content" v-else>
              <div v-if="this.$store.state.isSearchServerError" class="has-text-centered">
                <h1 class="title is-4">Service is currently unavailable.</h1>
                <p style="text-align: center;">Please
                  <span class="icon-text">
                    <a href="https://cveform.mitre.org/" target="_blank">report the issue
                      <span class="icon is-size-7 cve-icon-xxs">
                        <p id="extenalLink1" class="is-hidden">external site</p>
                        <font-awesome-icon icon="external-link-alt" aria-labelledby="extenalLink1" aria-hidden="false" focusable="false"/>
                      </span>
                    </a>
                  </span>
                  and try again later.<br/>Or, use
                  <a href="https://cve.mitre.org/cve/search_cve_list.html" target="_blank">Search CVE List on cve.mitre.org
                    <span class="icon is-size-7 cve-icon-xxs">
                      <p id="extenalLink1" class="is-hidden">external site</p>
                      <font-awesome-icon icon="external-link-alt" aria-labelledby="extenalLink1" aria-hidden="false" focusable="false"/>
                    </span>
                  </a>
                  to search CVE Records. Sorry for the inconvenience.
                </p>
              </div>
              <div v-else>
                <p v-if="this.$store.state.showHelpText" class="has-text-centered">
                  Please fix your query in the search box above.
                </p>
                <div v-else>
                  <div>
                    <p>
                      <span class="has-text-weight-bold">{{ this.$store.state.totalSearchResultCount }} results</span> for
                      <span class="has-text-weight-bold">{{ this.$store.state.query }}</span>
                    </p>
                  </div>
                  <div class="table-container" v-show="this.$store.state.totalSearchResultCount >= 0">
                    <table class="table is-striped is-hoverable cve-border-dark-blue is-fullwidth mb-1">
                      <thead>
                        <tr>
                          <th scope="col" class="is-hidden-desktop" >CVE ID</th>
                          <th scope="col" class="is-hidden-touch" style="width: 20%">CVE ID</th>
                          <th scope="col">Description</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr class="cve-get-record-result" v-if="Object.keys(this.$store.state.recordData).length > 0">
                          <td data-label="CVE ID" style="width: 20%">
                            {{ this.$store.state.cveId }}
                          </td>
                          <td data-label="Description" v-for="description in this.$store.state.recordData.descriptions" :key="description.id">
                            {{ description }}
                          </td>
                        </tr>
                        <tr class="cve-search-result" v-for="result in this.$store.state.searchResults" :key="result.id">
                          <td data-label="CVE ID" style="width: 20%">
                            {{ result.cveId }}
                          </td>
                          <td data-label="Description">
                            <p v-for="description in result.descriptions" :key="description.id">{{ description }}</p>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </main>
        </div>
      </div>
    </div>
</template>

<script>
export default ({
  name: 'SearchResults',
  data() {
    return {
      isMessageExpanded: false,
    };
  },
  methods: {
  },
});
</script>

<style lang="scss">
@import '@/assets/style/globals.scss';
@import '../../assets/style/elements/cveTableStacked.scss';

</style>
